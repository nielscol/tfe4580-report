\input{setup}

\pagestyle{fancy}
% \renewcommand{\sectionmark}[1]{\markboth{ #1}{}}
% \renewcommand{\subsectionmark}[1]{\markboth{\thesection\ #1}{\thesubsection\ #1}}
\fancyhf{}
\rhead{\fontfamily{\sfdefault}\selectfont \textbf{\rightmark}}
\lhead{\fontfamily{\sfdefault}\selectfont \textbf{Specialization Project}}
\rfoot{\fontfamily{\sfdefault}\selectfont \textbf{Page \thepage}}
\lfoot{\fontfamily{\sfdefault}\selectfont \textbf{Cole Nielsen}} % \today

\title{\textbf{}}
\date{}

\sloppy\raggedright
\begin{document}	
	\input{cover}
	\pagebreak
	\thispagestyle{blank}
	\null\pagebreak

	% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
	% Abstract		
	\setcounter{page}{1}
	\pagebreak
	\thispagestyle{nohdr}
	\begin{abstract}
		\large\fontfamily{\rmdefault}\selectfont 
		A pure-Python simulation and design automation framework for the design of integer-N all digital phase locked loop (ADPLL) frequency synthesizers is presented in this paper. The framework enables (a) automatic design of optimized discrete-time and quantized digital PLL loop filters, and (b) discrete-time simulation to verify filter and PLL designs for phase noise performance, lock-time and stability subject to variation using Monte-Carlo sampling. Simulation is performed with a discrete-event time domain simulator utilizing behavioral PLL component models, which permit accurate modeling effects of time-discretization and quantization in a ADPLL. Filter design automation is achieved via optimization of a prototype loop filter in a PLL for minimum total phase noise power and lock time, where lock time is maximally constrained. The optimizer utilizes continuous phase transfer function approximations of discrete PLL loop, allowing computationally fast estimates of phase noise and lock time. Thus continuous-to-discrete time conversion and coefficient quantization of the optimal filter is applied to yield a end loop-filter design. Second order optimization is utilized to minimize loop filter design error due to quantization effects.
	\end{abstract}
	% \section*{Abstract}
	% fjdsfkajjlkf

	% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
	% Project Description
	\pagebreak
	\thispagestyle{nohdr}
	\null\pagebreak
	\thispagestyle{nohdr}
	\Huge\textbf{Problem description.}\\
	\vspace{1em}
	\large\fontfamily{\rmdefault}\selectfont 
	
	To develop a standalone PLL simulation framework to aid and facilitate a later master's thesis project regarding the design of an all-digital, ultra-low power PLL (ULPPLL) frequency synthesizer. This framework is intended to address and ease all-digital PLL design and simulation challenges at a high level. Specifically it should allow for speedy PLL simulation defined with system and component- level specifications (e.g. desired frequency, gain of digitally contolled oscillator, phase detector resolution, divider modulus). This is to allow for development of component level specifications and validation of ideal PLL performance (phase noise, lock time, stability) before transistor level implementation. Furthermore, the framework should automate design of any pure-digital PLL components, namely loop-filter design, to accelerate overall time of PLL implementation.

	% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
	% % Preface
	% \pagebreak
	% \thispagestyle{nohdr}
	% \null\pagebreak
	% \thispagestyle{nohdr}
	% \large\fontfamily{\sfdefault}\selectfont 
	% \Huge\textbf{Preface.}\\
	% \vspace{1em}
	% \large\fontfamily{\rmdefault}\selectfont 
	% \lipsum[1]

	% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
	% Contents, list of tables and figures
	\fontfamily{\sfdefault}\selectfont 
	\thispagestyle{nohdr}
	\null\pagebreak
	\thispagestyle{nohdr}
	\null\pagebreak
	\tableofcontents
	\pagebreak
	\listoffigures
	\listoftables

	% \vhrulefill{\lineheight}

	\fontfamily{\rmdefault}\selectfont 
	% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
	% Abbreviations
	\input{abbrev.tex}

	% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
	\pagebreak
	\FloatBarrier

	\section{Introduction}\label{intro}
	\input{intro.tex}
	\pagebreak
	\FloatBarrier

	\section{Theory}\label{theory}
	\input{theory.tex}
	\input{theory2.tex}

	\section{Methods}\label{methods}
	\input{methods.tex}

    % \section{Results}
	\section{Discussion and results}\label{disco}
    \input{disco.tex}

	% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
    \FloatBarrier

    \section{Conclusion} \label{conclusion}
    Extend to fractional-N. Loop filter design will be the same, difference is divider model.

	\section{Baseband phase noise in radio with PLL}
		This doesn't have a home yet, perhaps appendices... will be relevant for BER estimation for radio system (will be referenced in discussion)

	\subsection{Modulated Signal}
		A generalized FSK/PSK modulated signal $x_s(t)$ can be written in the following with phase trajectory $\phi_s(t)$. $\phi_s(t)$ is composed of a modulation component $\phi_m(t)$ and carrier component $\omega_ct$.
		\begin{equation}
			x_s(t) = A_s\cos(\phi_s(t)) = A_s\cos(\phi_m(t)+\omega_ct)
		\end{equation} 

	\subsection{Local oscillator - noisy PLL}
		A noisy PLL can be realized as $x_{lo}(t)$ with phase trajectory $\phi_{lo}(t)$. $\phi_{lo}(t)$ is comprised of a phase noise component $\phi_{n}(t)$ and an oscillation $\omega_{lo}t$. 

		\begin{equation}
			x_{lo}(t)  = A_{lo}\cos(\phi_{lo}(t)) = A_{lo}\cos(\phi_n(t)+\omega_{lo}t)
		\end{equation} 

	\subsection{Baseband phase noise}
		The signal in the baseband, $x_{bb}(t)$, is given by mixing $x_{s}(t)$ with the LO $x_{lo}(t)$. For analysis of the baseband phase noise, zero-IF ($\omega_{c}=\omega_{lo}$) is considered. Thus:
		\begin{align}
			x_{bb}(t) & = A_s\cos(\phi_m(t)+\omega_ct)\cdot A_{lo}\cos(\phi_n(t)+\omega_{lo}t) \\
			& = \frac{1}{2}A_sA_{lo}\left[\cos(2\omega_{lo}t + \phi_m(t) + \phi_n(t)) +  \cos(\phi_m(t) - \phi_n(t))\right] 
		\end{align} 
		The $2\omega_{lo}t$ component is assumed to be rejected due to limited mixer bandwidth. Thus the baseband signal is now:
		\begin{align}
			x_{bb}(t) &= A_s\cos(\phi_m(t)+\omega_ct)\cdot A_{lo}\cos(\phi_n(t)+\omega_{lo}t)\\
			= & \frac{1}{2}A_sA_{lo}\left[\cos(\phi_m(t) - \phi_n(t))\right] = \frac{1}{4}A_sA_{lo}\left[e^{j\phi_m(t)} e^{-j\phi_n(t)} + e^{-j\phi_m(t)} e^{j\phi_n(t)}\right] 
		\end{align} 
		The phase noise is presumed to be comprised of random phase and frequency walk, such that $\langle\phi_n(t)\rangle = 0$. Also, the phase noise is presumed to be small in amplitude, such that $\phi_n(t) << 1$, so a Taylor polynomial-based approximation of $e^{-j\phi_n(t)} = 1 -j\phi_n(t)$ can be made. Accordingly :
		\begin{align}
			x_{bb}(t) \approx \frac{1}{4}A_sA_{lo}\left[e^{j\phi_m(t)}(1 -j\phi_n(t))+ e^{-j\phi_m(t)}(1+j\phi_n(t))\right] \\
			= \frac{1}{4}A_sA_{lo}\left[\cos(\phi_m(t)) + \phi_n(t)\sin(\phi_m(t))\right]
		\end{align} 
		The above can be treated as a signal component $m(t) = \cos(\phi_m(t))$, and a noise component $n(t) = \phi_n(t)\sin(\phi_m(t))$. The Fourier transform of the noise component can be considered:
		\begin{align}
			N(f) = \mathcal{F}\{\phi_n(t)\sin(\phi_m(t))\} &= \Phi_n(f)*\mathcal{F}\{-\cos(\phi_m(t)+\pi/2)\}\\
			& =-j\Phi_n(f)*\mathcal{F}\{\cos(\phi_m(t))\}
		\end{align}

		The signal and noise power spectral densities are therefore approximately:
		\begin{align}
			S_{MM} &= |M(f)|^2 = |\mathcal{F}\{\cos(\phi_m(t))\}|^2\\
			S_{NN} &= |N(f)|^2 = |\Phi_n(f)*\mathcal{F}\{\cos(\phi_m(t))\}|^2
		\end{align}
		The in-band noise and signal power of these components can be easily computed via integration:
		\begin{equation}
			P_x = \int^{+\Delta f/2}_{-\Delta f/2}S_{XX}df
		\end{equation}
		SNR is therefore the ratio of $P_M/P_N$ within a bandwidth of interest $\Delta f$, which is straightforward to determine computationally for arbitrary PLL phase noise and modulation spectral densities.


	% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
	% References
    \pagebreak
	\printbibliography


	% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
	% Appendix
	\pagebreak
	\include{appendix}


\end{document}